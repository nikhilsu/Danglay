<% provide(:title, 'Create new Cab Pool') %>
<% if FEATURES.active?('user_feature') %>
    <div class="row form-elements">


      <%= form_for(@cabpool, layout: :horizontal) do |f| %>
          <div class="col-50">
            <h2><%= "Create a Cab Pool" %></h2>
            <%= label_tag 'Capacity of Cab' %>
            <%= f.text_field :number_of_people %>
            <%= render 'shared/error_messages', errors: @cabpool.errors[:number_of_people] if !@cabpool.errors[:number_of_people].empty? %>
            <%= label_tag 'Arrival time to office' %>
            <%= f.time_field :timein, placeholder: 'HH:MM'%>
            <%= render 'shared/error_messages', errors: @cabpool.errors[:timein] if !@cabpool.errors[:timein].empty? %>
            <%= label_tag 'Departure time from office' %>
            <%= f.time_field :timeout, placeholder: 'HH:MM' %>
            <%= render 'shared/error_messages', errors: @cabpool.errors[:timeout] if !@cabpool.errors[:timeout].empty? %>
            <%= f.hidden_field :route, value: '' %>

            <div id="cabpool_type" class="<% unless @cabpool.errors[:cabpool_types].empty? %> field_with_errors<% end %>">
              <label for="cabpool_type">Cabpool Type</label>
              <div>
                <%= collection_select(:cabpool_type, DateTime.now.strftime('%Q').to_i, CabpoolType.all, :id, :name, {prompt: true}) %>
                <%= render 'shared/error_messages', errors: @cabpool.errors[:cabpool_types] if !@cabpool.errors[:cabpool_types].empty? %>
              </div>
            </div>

            <div class="form-group">
              <label class="label-blue" for="user_locality">Route</label>
              <div>
                <span class="label-name" id="locality"> <%= User.find_by_email(session[:Email]).locality.name %> </span>
                <%= hidden_field_tag 'localities[source]', User.find_by_email(session[:Email]).locality.id %>
                <div class="localityForm">
                  <label class="control-label required pull-left" for="user_locality">Via</label>
                  <%= collection_select(:localities, DateTime.now.strftime('%Q').to_i, Locality.all, :id, :name, {prompt: true}, class: 'form-control add-locality') %>
                </div>
                <%= render 'shared/error_messages', errors: @cabpool.errors[:localities] if !@cabpool.errors[:localities].empty? %>
              </div>
              <button id="addLocality">+</button>
            </div>

            <div id="localitySelections"></div>
            <%= f.submit "Create a pool", class: "btn-submit" %>
          </div>
          <div class="col-50">
            <h2>Route Map</h2>
            <div id="map" class="map"></div>
          </div>
          <script async defer
                  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCuETg3lyde0IR6XSO1WhVZY69bAp5owcs&callback=initMap">
          </script>
      <% end %>
    </div>
<% end %>
